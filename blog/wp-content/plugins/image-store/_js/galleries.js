function imsFileDialogStart(){jQuery("#media-upload-error").empty();swfu.addPostParam("folderpath",jQuery("#_ims_folder_path").val());swfu.addPostParam("cols",jQuery(".sort-images thead th:visible").length)}function imsUploadSuccess(a,b){if(b.match("media-upload-error")){jQuery("#media-item-"+a.id).html(b);return}postid=jQuery("#post_ID").val();prepareMediaItem(a,b);updateMediaForm();jQuery(".holder","#media-item-"+a.id).remove();if(jQuery("li.status-publish").length<1)jQuery('<li class="status-publish"><a href="'+imsgal.adminurl+"/post.php?post="+postid+'&action=edit&status=publish">'+postL10n.published+' <span class="count">(<span>1</span>)</span></a></li>').prependTo(".subsubsub");else jQuery("li.status-publish .count span").html(parseInt(jQuery("li.status-publish .count span").text())+1);if("1"==jQuery("#auto_draft").val()){autosaveLast="";jQuery("#auto_draft").val(2);autosave()}jQuery("#_ims_folder_path, #galleryfolder").val(jQuery("#_ims_folder_path").val()).attr({disabled:"disabled"})}function imsFileQueueError(a,b,c){if(b==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){wpQueueError(swfuploadL10n.queue_limit_exceeded)}else if(b==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT){imsFileQueued(a);imsFileError(a,swfuploadL10n.file_exceeds_size_limit)}else if(b==SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE){imsFileQueued(a);imsFileError(a,swfuploadL10n.zero_byte_file)}else if(b==SWFUpload.QUEUE_ERROR.INVALID_FILETYPE){imsFileQueued(a);imsFileError(a,swfuploadL10n.invalid_filetype)}else{wpQueueError(swfuploadL10n.default_error)}}function imsFileError(a,b){var c=jQuery("#media-item-"+a.id);var d=jQuery(".filename",c).text();c.html('<td class="holder" colspan="'+cols+'"><div class="error-div">'+'<a class="dismiss" href="#">'+swfuploadL10n.dismiss+"</a>"+"<strong>"+swfuploadL10n.error_uploading.replace("%s",d)+"</strong><br />"+b+"</div></td>");c.find("a.dismiss").click(function(){jQuery(this).parents(".media-item").slideUp(200,function(){jQuery(this).remove()})})}function imsFileQueued(a){jQuery(".media-blank").remove();if(jQuery("form.type-form #media-items").children().length==1&&jQuery(".hidden","#media-items").length>0){jQuery(".describe-toggle-on").show();jQuery(".describe-toggle-off").hide();jQuery(".slidetoggle").slideUp(200).siblings().removeClass("hidden")}cols=jQuery(".sort-images thead th:visible").length;jQuery("#media-items").prepend('<tr id="media-item-'+a.id+'" class="media-item iedit"><td class="holder" colspan="'+cols+'"><div class="progress"><div class="bar"></div></div><div class="filename original"><span class="percent"></span> '+a.name+"</div></td ></tr>");jQuery(".progress","#media-item-"+a.id).show();jQuery("#insert-gallery").attr("disabled","disabled");jQuery("#cancel-upload").attr("disabled","")}var uploaderMode=0;jQuery(document).ready(function(a){uploaderMode=getUserSetting("uploader");a(".upload-html-bypass a").click(function(){deleteUserSetting("uploader");uploaderMode=0;swfuploadPreLoad();return false});a(".upload-flash-bypass a").click(function(){setUserSetting("uploader","1");uploaderMode=1;swfuploadPreLoad();return false});a(".dismiss").live("click",function(){a(this).parents(".media-item").slideUp(200,function(){a(this).remove()});return false});a("a.imsdelete").live("click",function(){a(this).parents("tr").addClass("totrash").fadeIn().fadeOut();a.get(imslocal.imsajax,{action:"deleteimage",deletefile:imsgal.deletefile,parent:a("#post_ID").val(),postid:a(this).attr("href").replace("#",""),_wpnonce:imslocal.nonceajax});if(parseInt(a("li.status-trash .count span").text())-1>0)a("li.status-trash .count span").html(parseInt(a("li.status-trash .count span").text())-1);else a("li.status-trash").remove()});a("a.imsupdate").live("click",function(){a(this).parents("tr").addClass("doupdate").fadeOut(function(){a(this).removeClass("doupdate")}).fadeIn();a.get(imslocal.imsajax,{action:"upadateimage",_wpnonce:imslocal.nonceajax,imgid:a(this).attr("href").replace("#",""),caption:a(this).parents("tr").find("textarea").val(),order:a(this).parents("tr").find(".column-imorder input").val(),imgtitle:a(this).parents("tr").find(".column-imtitle input").val()});return false});a("a.imstrash").live("click",function(){a(this).parents("tr").addClass("totrash").fadeIn().fadeOut();a.get(imslocal.imsajax,{action:"editimstatus",_wpnonce:imslocal.nonceajax,status:a(this).attr("rel"),imgid:a(this).attr("href").replace("#","")});if(a("li.status-trash").length<1)a('<li class="status-trash"> | <a href="'+imsgal.adminurl+"/post.php?post="+a("#post_ID").val()+'&action=edit&status=trash">'+imsgal.trash+' <span class="count">(<span>1</span>)</span></a></li>').appendTo(".subsubsub");else a("li.status-trash .count span").html(parseInt(a("li.status-trash .count span").text())+1);if(parseInt(a("li.status-publish .count span").text())-1>0)a("li.status-publish .count span").html(parseInt(a("li.status-publish .count span").text())-1);else a("li.status-publish").remove();return false});a("a.imsrestore").live("click",function(){a(this).parents("tr").addClass("restore").fadeIn().fadeOut();a.get(imslocal.imsajax,{action:"editimstatus",_wpnonce:imslocal.nonceajax,status:a(this).attr("rel"),imgid:a(this).attr("href").replace("#","")});if(a("li.status-publish").length<1)a('<li class="status-publish"><a href="'+imsgal.adminurl+"/post.php?post="+a("#post_ID").val()+'&action=edit&status=trash">'+postL10n.published+' <span class="count">(<span>1</span>)</span></a> | </li>').prependTo(".subsubsub");else a("li.status-publish .count span").html(parseInt(a("li.status-publish .count span").text())+1);if(parseInt(a("li.status-trash .count span").text())-1>0)a("li.status-trash .count span").html(parseInt(a("li.status-trash .count span").text())-1);else a("li.status-trash").remove();return false});a("#scannfolder").click(function(){a("#import_folder .loading").show()});var b=parseInt(a("input.sort_count").val());a("table.sort-images tbody").sortable({axis:"y",cursor:"move",helper:"clone",placeholder:"widget-placeholder",update:function(){a(this).find("tr").each(function(){a(this).find(".column-imorder input").val(b++);if(b%2!=0)a(this).removeClass("alternate").addClass("alternate");else a(this).removeClass("alternate")});b=parseInt(a("input.sort_count").val())}});a("table.sort-images tbody tr").disableSelection();a("#date").datepicker({altField:"#post_date",altFormat:"yy-m-d",dateFormat:imslocal.dateformat});a("#imsexpire").datepicker({altField:"#_ims_expire",altFormat:"yy-m-d",dateFormat:imslocal.dateformat})})