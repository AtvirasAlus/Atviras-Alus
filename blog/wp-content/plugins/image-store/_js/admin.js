jQuery(document).ready(function(a){a(".ims-box").hide();a(".ims-box").eq(0).show();a(".ims-tabs li").eq(0).addClass("current");if(hash=window.location.hash){a(".ims-box").hide();a(".ims-tabs li").removeClass("current");index=a(".ims-tabs li a").index(a("a[href|="+hash+"]"));a(".ims-tabs li").eq(index).addClass("current");a(hash).show();a(window).delay(20).scrollTop(0)}a(window).bind("hashchange",function(){a(window).scrollTop(0)});a(".ims-tabs li").click(function(){a("#message").remove();a(".ims-box").hide();a(".ims-tabs li").removeClass("current");a(".ims-box").eq(a(".ims-tabs li").index(a(this))).show();a(this).addClass("current")});a("select[name=userid]").change(function(){if(a(this).val()>0){window.location.search="post_type=ims_gallery&page=ims-settings&userid="+a(this).val();window.location.href=window.location}});a(".show-free").hide();a("tbody.content").hide();a("tbody.content").hide();a("tfoot.content").hide();a(".show-download").hide();a(".itemtop a").toggle(function(){a(this).html("[-]");index=a(".itemtop a").index(a(this));a("tbody.content").eq(index).show();a("tfoot.content").eq(index).show();if(a("tbody.content").eq(index).find("tr.size").length<=0)a("tr.filler").eq(index).show();else a("tr.filler").eq(index).hide();a(".price-list tbody").sortable("refresh");a(".package-list tbody").sortable("refresh")},function(){a(this).html("[+]");index=a(".itemtop a").index(a(this));a("tbody.content").eq(index).hide();a("tfoot.content").eq(index).hide();a("tr.filler").eq(index).hide();a(".price-list tbody").sortable("refresh");a(".package-list tbody").sortable("refresh")});counter=a("#image_sizes tbody tr").length;a(".add-image-size").click(function(){row=a(this).parents(".postbox").find(".copyrow").clone().removeClass("copyrow");row.find(".name").attr("name","sizes["+counter+"][name]").removeAttr("value");row.find(".price").attr("name","sizes["+counter+"][price]");row.find(".width").attr("name","sizes["+counter+"][w]");row.find(".height").attr("name","sizes["+counter+"][h]");row.find(".unit").attr("name","sizes["+counter+"][unit]");a(this).parents(".postbox").find(".copyrow").before(row);counter++;return false});a("#price-list-box input.downloadable").live("click",function(){if(a(this).is(":checked"))a(this).parents("tr.size").find("td").eq(1).append("<em>"+imslocal.download+"</em>");else a(this).parents("tr.size").find("td").eq(1).find("em").remove()});a("td.x").live("click",function(){if(a(this).parent().parent().find("tr.size").length<=1)a("tr.filler").show();a(this).parent().remove()});a("#price-list .trash").click(function(){del=confirm(imslocal.deletelist);if(del){id=a(this).parent().find(".listid").val();a.get(imslocal.imsajax,{action:"deletelist",postid:id,_wpnonce:imslocal.nonceajax},function(){a("#ims-list-"+id).remove()})}return false});a("#packages .trash").click(function(){del=confirm(imslocal.deletepackage);if(del){id=a(this).parent().find(".packageid").val();a.get(imslocal.imsajax,{postid:id,action:"deletepackage",_wpnonce:imslocal.nonceajax},function(){a("#package-list-"+id).remove()})}return false});a("#promo_type").change(function(){if(a(this).val()==3)a('input[name="discount"]').attr({disabled:"disabled"});else a('input[name="discount"]').removeAttr("disabled")});if(jQuery().sortable){i=0;a(".price-list tbody").sortable({cursor:"move",placeholder:"widget-placeholder",stop:function(b,c){a("tr.filler").hide();c.item.attr("class","alternate size").removeAttr("style");a(this).find("tr").each(function(){a(this).find(".id").attr({name:"sizes["+i+"][ID]"});a(this).find(".unit").attr({name:"sizes["+i+"][unit]"});a(this).find(".price").attr({name:"sizes["+i+"][price]"});a(this).find(".name").attr({name:"sizes["+i+"][name]"});a(this).find(".downloadable").attr({name:"sizes["+i+"][download]"});i++});i=0}});a("#packages .package-list tbody").sortable({cursor:"move",placeholder:"widget-placeholder",stop:function(b,c){a("tr.filler").hide();c.item.find(".price").remove();c.item.attr("class","alternate size").removeAttr("style")}});a("tr.size").disableSelection()}if(jQuery().draggable){a("#price-list .sizes-list .size,#price-list .package-list .size").draggable({helper:"clone",revert:"invalid",connectToSortable:".price-list tbody",drop:function(b,c){a(this).parents("tbody").find("tr").each(function(){a(this).find(".id").attr({name:"sizes["+i+"][ID]"});a(this).find(".unit").attr({name:"sizes["+i+"][unit]"});a(this).find(".price").attr({name:"sizes["+i+"][price]"});a(this).find(".name").attr({name:"sizes["+i+"][name]"});a(this).find(".downloadable").attr({name:"sizes["+i+"][download]"});i++});i=0}});a("#packages .sizes-list .size").draggable({helper:"clone",revert:"invalid",handle:".move",connectToSortable:".package-list tbody"})}if(jQuery().datepicker){a("#starts").datepicker({altField:"#start_date",altFormat:"yy-m-d",dateFormat:imslocal.dateformat});a("#expires").datepicker({altField:"#expiration_date",altFormat:"yy-m-d",dateFormat:imslocal.dateformat})}})